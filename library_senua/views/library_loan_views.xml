<?xml version="1.0" encoding="UTF-8"?>

<odoo>
    <!-- Form View -->
    <record id="view_library_loan_form" model="ir.ui.view">
        <field name="name">library.loan.form</field>
        <field name="model">library.loan</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <group>
                        <group>
                            <field name="book_id" />
                            <field name="book_isbn" />
                            <field name="borrower_id" />
                        </group>
                        <group>
                            <field name="loan_date" />
                            <field name="return_date" />
                            <field name="state" />
                            <field name="is_late" />
                            <field name="days_late" readonly="1" invisible="not is_late" />
                        </group>
                    </group>
                    <notebook>
                        <page string="Notes">
                            <field name="notes" />
                        </page>
                    </notebook>
                </sheet>
                <chatter/>
            </form>
        </field>
    </record>

    <!-- List View -->
    <record id="view_library_loan_list" model="ir.ui.view">
        <field name="name">library.loan.list</field>
        <field name="model">library.loan</field>
        <field name="arch" type="xml">
            <list>
                <field name="book_id" />
                <field name="book_isbn" />
                <field name="borrower_id" />
                <field name="loan_date" />
                <field name="return_date" />
                <field name="state" />
            </list>
        </field>
    </record>

    <!-- Calendar View -->
    <record id="view_library_loan_calendar" model="ir.ui.view">
        <field name="name">library.loan.calendar</field>
        <field name="model">library.loan</field>
        <field name="arch" type="xml">
            <calendar string="Loans Calendar"
                date_start="loan_date"
                date_stop="return_date"
                color="state"
                mode="month">
                <field name="book_id" />
                <field name="borrower_id" />
                <field name="state" />
            </calendar>
        </field>
    </record>

    <!-- Graph View -->
    <record id="view_library_loan_graph" model="ir.ui.view">
        <field name="name">library.loan.graph</field>
        <field name="model">library.loan</field>
        <field name="arch" type="xml">
            <graph string="Loans Statistics" type="bar">
                <field name="book_id" />
                <field name="state" type="col" />
            </graph>
        </field>
    </record>

    <!-- Pivot View -->
    <record id="view_library_loan_pivot" model="ir.ui.view">
        <field name="name">library.loan.pivot</field>
        <field name="model">library.loan</field>
        <field name="arch" type="xml">
            <pivot string="Loans Analysis">
                <field name="book_id" type="row" />
                <field name="loan_date" interval="month" type="col" />
                <field name="days_late" type="measure" />
            </pivot>
        </field>
    </record>

    <!-- Search View -->
    <record id="view_library_book_search" model="ir.ui.view">
        <field name="name">library.book.search</field>
        <field name="model">library.book</field>
        <field name="arch" type="xml">
            <search string="Search Books">
                <!-- Search by title or author -->
                <field name="name" string="Title" filter_domain="[('name','ilike',self)]" />
                <field name="author_id" string="Author" />
                <field name="isbn" />

                <!-- Filters -->
                <filter string="Available" name="filter_available"
                    domain="[('state','=','available')]" />
                <filter string="On Loan" name="filter_loaned" domain="[('state','=','loaned')]" />
                <filter string="Overdue" name="filter_overdue" domain="[('state','=','overdue')]" />

                <separator />

                <!-- Group by -->
                <filter string="Author" name="group_author" context="{'group_by':'author_id'}" />
                <filter string="State" name="group_state" context="{'group_by':'state'}" />
            </search>
        </field>
    </record>

    <!-- Action Window -->
    <record id="action_library_loan" model="ir.actions.act_window">
        <field name="name">Loans</field>
        <field name="res_model">library.loan</field>
        <field name="view_mode">list,form,calendar,graph,pivot</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Manage library loans here!
            </p>
        </field>
    </record>
</odoo>